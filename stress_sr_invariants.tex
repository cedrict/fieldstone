\begin{flushright} {\tiny {\color{gray} stress\_sr\_invariants.tex}} \end{flushright}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The implementation of the plasticity criterions relies essentially 
on the (moment) invariants $\III_{1,2,3}$ of the (deviatoric) stress ${\bm \tau}$ 
and the (deviatoric) strainrate tensors $\dot{\bm \varepsilon}$:

\begin{eqnarray}
{\III}_1({\bm \sigma}) &=& \sigma_{xx}+\sigma_{yy}+\sigma_{zz}\\
{\III}_2({\bm \tau})   
&=&\frac{1}{2}(\tau_{xx}^2 + \tau_{yy}^2 + \tau_{zz}^2 ) + \tau_{xy}^2 + \tau_{xz}^2 + \tau_{yz}^2  \\
{\III}_3({\bm \tau}) 
&=& \frac{1}{3} \tau_{xx} (  \tau_{xx}^2 + 3 \tau_{xy}^2 + 3 \tau_{xz}^2  )     \nonumber\\
&+& \frac{1}{3} \tau_{yy} (3 \tau_{xy}^2 +   \tau_{yy}^2 + 3 \tau_{yz}^2  )     \nonumber\\
&+& \frac{1}{3} \tau_{zz} (3 \tau_{xz}^2 + 3 \tau_{yz}^2 +   \tau_{zz}^2)       \nonumber\\
&+& 2 \tau_{xy} \tau_{xz} \tau_{yz}  
\end{eqnarray}
and also the second invariant of the deviatoric strain rate is:
\begin{eqnarray}
{\III}_2(\dot{\bm{\varepsilon}}^d)
&=& \frac{1}{2} \left[ (\dot{\varepsilon}_{xx}^d)^2 + (\dot{\varepsilon}_{yy}^d)^2 + (\dot{\varepsilon}_{zz}^d)^2   \right] 
+ (\dot{\varepsilon}_{xy}^d)^2  
+ (\dot{\varepsilon}_{xz}^d)^2  
+ (\dot{\varepsilon}_{yz}^d)^2  \nonumber\\
&=& \frac{1}{6} \left[ (\dot{\varepsilon}_{xx}-\dot{\varepsilon}_{yy})^2 
+ (\dot{\varepsilon}_{yy}-\dot{\varepsilon}_{zz})^2 
+ (\dot{\varepsilon}_{xx}-\dot{\varepsilon}_{zz})^2 \right] 
+ \dot{\varepsilon}_{xy}^2 + \dot{\varepsilon}_{xz}^2 + \dot{\varepsilon}_{yz}^2 \label{eq:I2epsd} 
\end{eqnarray}
Proofs of these relationships are given in Appendix~\ref{app:invariants}.

We have 
\begin{eqnarray}
\tau_{xx}^2 + \tau_{yy}^2 + \tau_{zz}^2
&=& 
\left(\sigma_{xx}-\frac13 I_1\right)^2 + 
\left(\sigma_{yy}-\frac13 I_1\right)^2 + 
\left(\sigma_{zz}-\frac13 I_1\right)^2  \nonumber\\
&=&
\sigma_{xx}^2 + \sigma_{yy}^2 + \sigma_{zz}^2 
-\frac23 I_1 (\sigma_{xx} + \sigma_{yy} + \sigma_{zz}) 
+3\frac19 I_1^2 \nonumber\\
&=&
\sigma_{xx}^2 + \sigma_{yy}^2 + \sigma_{zz}^2 
-\frac23 I_1^2 +\frac13 I_1^2 \nonumber\\
&=&
\sigma_{xx}^2 + \sigma_{yy}^2 + \sigma_{zz}^2 
-\frac13 I_1^2  \nonumber\\
&=&
\sigma_{xx}^2 + \sigma_{yy}^2 + \sigma_{zz}^2 
-\frac13 (\sigma_{xx} + \sigma_{yy} + \sigma_{zz})^2 \nonumber\\
&=&
\sigma_{xx}^2 + \sigma_{yy}^2 + \sigma_{zz}^2 
-\frac13 (\sigma_{xx}^2 + \sigma_{yy}^2 + \sigma_{zz}^2
+2\sigma_{xx}\sigma_{yy}+2\sigma_{xx}\sigma_{zz}+2\sigma_{yy}\sigma_{zz} ) 
\nonumber\\
&=& \frac13 (
3\sigma_{xx}^2 + 3\sigma_{yy}^2 + 3\sigma_{zz}^2 
-\sigma_{xx}^2 - \sigma_{yy}^2 - \sigma_{zz}^2
-2\sigma_{xx}\sigma_{yy}-2\sigma_{xx}\sigma_{zz}-2\sigma_{yy}\sigma_{zz} ) 
\nonumber\\
&=& \frac13 (
2\sigma_{xx}^2 + 2\sigma_{yy}^2 + 2\sigma_{zz}^2 
-2 \sigma_{xx}\sigma_{yy}-2 \sigma_{xx}\sigma_{zz}-2 \sigma_{yy}\sigma_{zz} )\\
&=& \frac13 ((\sigma_{xx}-\sigma_{yy})^2 + (\sigma_{xx}-\sigma_{zz})^2
+ (\sigma_{yy}-\sigma_{zz})^2)
\end{eqnarray}
so that 
\[
{\III}_2({\bm \tau})   
=\frac{1}{6}\left[(\sigma_{xx}-\sigma_{yy})^2 + (\sigma_{yy}-\sigma_{zz})^2 + (\sigma_{xx}-\sigma_{zz})^2 \right]  
+ \sigma_{xy}^2 + \sigma_{xz}^2 + \sigma_{yz}^2 
\]

\begin{remark}
${\III}_2({\bm \tau})$ is often called $J_2$ or $J_2'$ so that one sometimes speaks of $J_2$-plasticity.
\end{remark}

These (second) invariants are almost always used under a square root so we define:
\begin{mdframed}[backgroundcolor=blue!5]
\begin{equation}
\tau_{e}=\sqrt{{\III}_2({\bm \tau})}
\quad\quad
\quad\quad
\dot{\varepsilon}_{e}=\sqrt{{\III}_2(\dot{\bm \varepsilon}^d)}
\label{eq:tauepse}
\end{equation}
\end{mdframed}
Note that these quantities have the same dimensions as their tensor counterparts, i.e. $\si{\pascal}$ 
for stresses and $\si{\per\second}$ for strain rates.

If the stress tensor is such that it is diagonal, i.e.
\[
{\bm \sigma}= \left( \begin{array}{ccc}
\sigma_1 & 0 & 0 \\
0 & \sigma_2 & 0 \\
0 & 0 & \sigma_3
\end{array}\right)
\qquad
{\rm and}
\qquad
{\bm \tau}= \left( \begin{array}{ccc}
\tau_1 & 0 & 0 \\
0 & \tau_2 & 0 \\
0 & 0 & \tau_3
\end{array}\right)
\]
then the invariants are 
\begin{eqnarray}
{\III}_1({\bm \sigma}) &=& \sigma_1 + \sigma_2+ \sigma_3 \nonumber\\
{\III}_2({\bm \tau}) &=& \frac{1}{6}\left[(\sigma_{1}-\sigma_{2})^2 + (\sigma_{2}-\sigma_{3})^2 
+ (\sigma_{1}-\sigma_{3})^2 \right] \label{eq:I2s123}\\ 
{\III}_3({\bm \tau}) 
&=& \tau_1\tau_2\tau_3 \nn\\
&=& \frac{1}{3} {\rm tr}[{\bm \tau}\cdot{\bm \tau}\cdot {\bm \tau}]  \nn\\
&=& \frac{1}{3} {\rm tr}
\left[
\left(
\begin{array}{ccc}
\tau_1 & 0 & 0 \\
0 & \tau_2 & 0 \\
0 & 0 & \tau_3 
\end{array}
\right)
\cdot
\left(
\begin{array}{ccc}
\tau_1 & 0 & 0 \\
0 & \tau_2 & 0 \\
0 & 0 & \tau_3 
\end{array}
\right)
\cdot
\left(
\begin{array}{ccc}
\tau_1 & 0 & 0 \\
0 & \tau_2 & 0 \\
0 & 0 & \tau_3 
\end{array}
\right)
\right] \nn\\
&=&  \frac{1}{3} {\rm tr}
\left(
\begin{array}{ccc}
\tau_1^3 & 0 & 0 \\
0 & \tau_2^3 & 0 \\
0 & 0 & \tau_3^3 
\end{array}
\right) \nn\\
&=& \frac{1}{3}(\tau_1^3+\tau_2^3+\tau_3^3) \nn\\
&=&  \frac{1}{3} [ 
(\sigma_1-{\III}_1({\bm \sigma})/3)^3+  
(\sigma_2-{\III}_1({\bm \sigma})/3)^3+
(\sigma_3-{\III}_1({\bm \sigma})/3)^3 ]   \nonumber\\ 
&=&  \frac{1}{3\cdot 27} [ 
(3\sigma_1-{\III}_1({\bm \sigma}))^3+  
(3\sigma_2-{\III}_1({\bm \sigma}))^3+
(3\sigma_3-{\III}_1({\bm \sigma}))^3 ]   \nonumber\\ 
&=& \frac{1}{81}
\left[
(2\sigma_1-\sigma_2-\sigma_3)^3+
(2\sigma_2-\sigma_1-\sigma_3)^3+
(2\sigma_3-\sigma_1-\sigma_2)^3
\right] 
\label{eq:3rdinvb} \label{eq:I3tau}
\end{eqnarray}
The formulation of the third invariant of ${\bm \tau}$  in Eq.~\ref{eq:I3tau} 
is used in Wojciechowski \cite{wojc18}.











