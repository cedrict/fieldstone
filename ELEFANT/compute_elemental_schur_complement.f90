!==================================================================================================!
!==================================================================================================!
!                                                                                                  !
! ELEFANT                                                                        C. Thieulot       !
!                                                                                                  !
!==================================================================================================!
!==================================================================================================!

subroutine compute_elemental_schur_complement(K_el,G_el,S_el)

!use module_parameters
!use module_mesh 
!use module_constants
!use module_swarm
!use module_materials
!use module_arrays
use module_timing

implicit none


!==================================================================================================!
!==================================================================================================!
!@@ \subsection{compute_elemental_schur_complement}
!@@
!==================================================================================================!


   ! build elemental approximate Schur complement
   ! only keep diagonal of K
   ! should this happen before bc are applied?
   ! add C_el ?
   do k1=1,mV
   do k2=1,mV
      if (k1/=k2) K_el(k1,k2)=0d0
      if (k1==k2) K_el(k1,k2)=1d0/K_el(k1,k2)
   end do
   end do
   S_el=matmul(transpose(G_el),matmul(K_el,G_el))

end subroutine

!==================================================================================================!
!==================================================================================================!
