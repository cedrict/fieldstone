!==================================================================================================!
!==================================================================================================!
!                                                                                                  !
! ELEFANT                                                                        C. Thieulot       !
!                                                                                                  !
!==================================================================================================!
!==================================================================================================!

subroutine experiment_declare_main_parameters

use module_parameters

implicit none

!----------------------------------------------------------

!geometry='spherical'
!ndim=2
!nelr=2
!nelphi=8
!inner_radius=1
!outer_radius=2

ndim=2
geometry='cartesian'


Lx=1
Ly=1

nelx=32
nely=32

spaceVelocity='__Q3'
spacePressure='__Q2'
!mapping='__Q3'

debug=.true.

use_penalty=.false.
penalty=1d6

nqpts=3

solve_stokes_system=.False.

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_define_material_properties

implicit none

!----------------------------------------------------------


!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_material_model(x,y,z,p,T,exx,eyy,ezz,exy,exz,eyz,imat,mode,&
                          eta,rho,hcond,hcapa,hprod)

implicit none

real(8), intent(in) :: x,y,z,p,T,exx,eyy,ezz,exy,exz,eyz
integer, intent(in) :: imat,mode
real(8), intent(out) :: eta,rho,hcond,hcapa,hprod

!----------------------------------------------------------

eta=1
rho=1

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_swarm_material_layout 

implicit none

!----------------------------------------------------------


!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_define_bcV

use module_parameters, only: iel,nel,mV
use module_mesh

implicit none

!----------------------------------------------------------

integer k

do iel=1,nel
   mesh(iel)%fix_u(:)=.false. 
   mesh(iel)%fix_v(:)=.false. 
end do

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_define_bcT

implicit none

!----------------------------------------------------------


!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_initial_temperature

implicit none

!----------------------------------------------------------

! your stuff here

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_analytical_solution(x,y,z,u,v,w,p,T,exx,eyy,ezz,exy,exz,eyz)

implicit none

real(8), intent(in) :: x,y,z
real(8), intent(out) :: u,v,w,p,T,exx,eyy,ezz,exy,exz,eyz

!----------------------------------------------------------

! your stuff here

u=1-x**2
v=1+y**2
w=0
p=sqrt(x)
T=0
exx=0
eyy=0
ezz=0
exy=0
exz=0
eyz=0

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_gravity_model(x,y,z,gx,gy,gz)

implicit none

real(8), intent(in) :: x,y,z
real(8), intent(out) :: gx,gy,gz

!----------------------------------------------------------

gx=0
gy=-1
gz=0

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_test

implicit none

!----------------------------------------------------------

! your stuff here

!----------------------------------------------------------

end subroutine

!==================================================================================================!

subroutine experiment_postprocessor

implicit none

!----------------------------------------------------------

! your stuff here

!----------------------------------------------------------

end subroutine

!==================================================================================================!
