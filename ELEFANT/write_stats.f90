!==================================================================================================!
!==================================================================================================!
!                                                                                                  !
! ELEFANT                                                                        C. Thieulot       !
!                                                                                                  !
!==================================================================================================!
!==================================================================================================!

subroutine write_stats

use module_parameters
use module_statistics 
use module_timing

implicit none

!==================================================================================================!
!==================================================================================================!
!@@ \subsection{write\_stats}
!@@ This subroutine writes in fort.1234 various statistics (istep, time, vrms, averages, 
!@@ errors, ...) 
!==================================================================================================!

if (iproc==0) then

call system_clock(counti,count_rate)

!==============================================================================!

if (istep==1) write(1234,'(a)') '#   01          02     03          04          05          06        07    08      09     10     11     12      13'
if (istep==1) write(1234,'(a)') '#istep        time    nel        vrms        errv        errp      errq   vol  avrg_u avrg_v avrg_w avrg_p  avrg_T' 

write(1234,'(i6,es12.4,i7,10es12.4)') istep,time,nel,vrms,errv,errp,errq,&
              volume,avrg_u,avrg_v,avrg_w,avrg_p,avrg_T

call flush(1234)

!==============================================================================!

call system_clock(countf) ; elapsed=dble(countf-counti)/dble(count_rate)

write(*,'(a,f6.2,a)') 'write_stats:',elapsed,' s                    |'

end if ! iproc

end subroutine

!==================================================================================================!
!==================================================================================================!
