\begin{flushright} {\tiny {\color{gray} strainrate\_tensor.tex}} \end{flushright}


The strain rate tensor $\dot{\bm\varepsilon}(\vec\upnu)$ is given by
\begin{equation}
\dot{\bm \varepsilon}({\vec \upnu}) 
= \frac{1}{2} \left( {\vec \nabla}{\vec \upnu}+ ({\vec \nabla}{\vec \upnu})^T \right) 
\end{equation}

%.....................................
\subsection{Cartesian coordinates}
\begin{eqnarray}
\dot\varepsilon_{xx} &=& \frac{\partial u}{\partial x} \\
\dot\varepsilon_{yy} &=& \frac{\partial v}{\partial y} \\
\dot\varepsilon_{zz} &=& \frac{\partial w}{\partial z} \\
\dot\varepsilon_{yx} =
\dot\varepsilon_{xy} &=& \frac{1}{2} \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}  \right)\\
\dot\varepsilon_{zx} =
\dot\varepsilon_{xz} &=& \frac{1}{2} \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x}  \right)\\
\dot\varepsilon_{zy} =
\dot\varepsilon_{yz} &=& \frac{1}{2} \left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y}  \right)
\end{eqnarray}

In the \aspect manual there is an interesting discussion about the strain rate tensor in the case of 
2D models: 
\begin{displayquote}
{\color{darkgray}
The notion we adopt here is to think of two-dimensional models in the following way: 
We assume that the domain we want to solve on is a two-dimensional
cross section (parameterized by x and y coordinates) that extends infinitely far in both negative and positive
z direction. Further, we assume that the velocity is zero in z direction and that all variables have no
variation in z direction. As a consequence, we ought to really think of these two-dimensional models as
three-dimensional ones in which the z component of the velocity is zero and so are all z derivatives.}
\end{displayquote}

This of course makes sense but it means that when the deviatoric strain rate tensor needs to be 
computed, then it is given by
\[
\dot{\bm \varepsilon}^d = \dot{\bm \varepsilon} 
- \frac{1}{\bm 3} (\vec\nabla\cdot\vec\upnu) {\bm 1}
=
\left(
\begin{array}{ccc}
\dot{\varepsilon}_{xx} & \dot{\varepsilon}_{xy} &  0 \\
\dot{\varepsilon}_{xy} & \dot{\varepsilon}_{yy} &  0 \\
0 &0 & 0
\end{array}
\right)
- \frac{1}{\bm 3} (\dot{\varepsilon}_{xx}+\dot{\varepsilon}_{yy}) {\bm 1}
=
\frac{1}{3}
\left(
\begin{array}{ccc}
2 \dot{\varepsilon}_{xx} - \dot{\varepsilon}_{yy} & 3\dot{\varepsilon}_{xy} &  0 \\
3\dot{\varepsilon}_{xy} & -\dot{\varepsilon}_{xx}+2 \dot{\varepsilon}_{yy} &  0 \\
0 &0 & -\dot{\varepsilon}_{xx}-\dot{\varepsilon}_{yy}
\end{array}
\right)
\]
As a consequence the shear heating term $\Phi$ is given by 
\begin{eqnarray}
\Phi = 2 \eta \dot{\bm \varepsilon}^d :\dot{\bm \varepsilon}^d 
&=& 2 \eta \frac19
\left[
(2\dot{\varepsilon}_{xx}-\dot{\varepsilon}_{yy})^2 +
(-\dot{\varepsilon}_{xx}+2\dot{\varepsilon}_{yy})^2 +
2\cdot 9\dot{\varepsilon}_{xy}^2
+( -\dot{\varepsilon}_{xx}-\dot{\varepsilon}_{yy})^2 \right] \nn\\
&=& 2\eta \frac19
\left[
4\dot{\varepsilon}_{xx}^2 - 4 \dot{\varepsilon}_{xx}\dot{\varepsilon}_{yy}
+\dot{\varepsilon}_{yy}^2
+ \dot{\varepsilon}_{xx}^2 - 4 \dot{\varepsilon}_{xx}\dot{\varepsilon}_{yy}
+ 4\dot{\varepsilon}_{yy}^2
+ 18 \dot{\varepsilon}_{xy}^2
+ \dot{\varepsilon}_{xx}^2 +2\dot{\varepsilon}_{xx}\dot{\varepsilon}_{yy}
+ \dot{\varepsilon}_{yy}^2 \right] \nn\\
&=& 2\eta \frac19
\left[ 6 \dot{\varepsilon}_{xx}^2 
+ 6 \dot{\varepsilon}_{yy}^2 
-6 \dot{\varepsilon}_{xx}\dot{\varepsilon}_{yy}
+ 18 \dot{\varepsilon}_{xy}^2 \right] \nn\\
&=& 2\eta \left[ \frac{2}{3} \dot{\varepsilon}_{xx}^2 
+ \frac23 \dot{\varepsilon}_{yy}^2 
-\frac23 \dot{\varepsilon}_{xx}\dot{\varepsilon}_{yy}
+ 2 \dot{\varepsilon}_{xy}^2 \right]
\end{eqnarray}


%.............................................
\subsection{Polar coordinates \label{ss:srpc}}

\begin{eqnarray}
\dot\varepsilon_{rr} 
&=& \frac{\partial \upnu_r}{\partial r} \nn\\
\dot\varepsilon_{\theta\theta} 
&=& \frac{\upnu_r}{r} + \frac{1}{r} \frac{\partial \upnu_\theta}{\partial \theta}  \nn\\
\dot\varepsilon_{\theta r} = \dot\varepsilon_{r\theta} 
&=& \frac{1}{2} \left(   \frac{\partial \upnu_\theta}{\partial r} - \frac{\upnu_\theta}{r} 
+\frac{1}{r} \frac{\partial \upnu_r}{\partial \theta}  \right)  \nn
\end{eqnarray}



%........................................................
\subsection{Cylindrical coordinates \label{ss:srcc}}

\begin{eqnarray}
\dot\varepsilon_{rr} 
&=& \frac{\partial \upnu_r}{\partial r} 
\\
\dot\varepsilon_{\theta\theta} 
&=& \frac{\upnu_r}{r} + \frac{1}{r} \frac{\partial \upnu_\theta}{\partial \theta}  
\\
\dot\varepsilon_{\theta r} = \dot\varepsilon_{r\theta} 
&=& \frac{1}{2} \left(   \frac{\partial \upnu_\theta}{\partial r} - \frac{\upnu_\theta}{r} 
+\frac{1}{r} \frac{\partial \upnu_r}{\partial \theta}  \right)
\\
\dot\varepsilon_{zz} 
&=& \frac{\partial \upnu_z}{\partial z} 
\\
\dot{\varepsilon}_{rz} = \dot{\varepsilon}_{zr} 
&=& \frac{1}{2}\left( \frac{\partial \upnu_r}{\partial z} + \frac{\partial \upnu_z}{\partial r}  \right) 
\\
\dot{\varepsilon}_{\theta z} = \dot{\varepsilon}_{z \theta} &=& \frac{1}{2}\left( 
\frac{1}{r} \frac{\partial \upnu_z}{\partial \theta} + \frac{\partial \upnu_\theta}{\partial z}  \right) 
\end{eqnarray}


The velocity divergence is given by
\begin{eqnarray}
\vec{\nabla}\cdot\vec\upnu 
&=& \dot{\varepsilon}_{rr} + \dot{\varepsilon}_{\theta\theta} + \dot{\varepsilon}_{zz} 
 = \cfrac{\partial \upnu_r}{\partial r} + \cfrac{1}{r}\left(\cfrac{\partial \upnu_\theta}{\partial \theta} 
+ \upnu_r \right)  + \cfrac{\partial \upnu_z}{\partial z}
\end{eqnarray} 


%......................................................
\subsection{Spherical coordinates \label{ss:srsc}}

\begin{eqnarray}
\dot\varepsilon_{rr} 
&=& \frac{\partial \upnu_r}{\partial r} \\
\dot\varepsilon_{\theta\theta} 
&=& \frac{\upnu_r}{r} + \frac{1}{r} \frac{\partial \upnu_\theta}{\partial \theta}  \\
\dot\varepsilon_{\phi\phi} 
&=& \frac{1}{r \sin\theta} \frac{\partial \upnu_\phi}{\partial \phi} +
\frac{\upnu_r}{r} +\frac{\upnu_\theta \cot \theta}{r} \\
\dot\varepsilon_{\theta r} = \dot\varepsilon_{r\theta}   
&=& \frac{1}{2} \left( r \frac{\partial}{\partial r} (\frac{\upnu_\theta}{r} ) 
+\frac{1}{r} \frac{\partial \upnu_r}{\partial \theta} \right) \\
\dot\varepsilon_{\phi r} = \dot\varepsilon_{r\phi}      
&=&  \frac{1}{2} \left(  \frac{1}{r \sin\theta} \frac{\partial \upnu_r}{\partial \phi} 
+ r \frac{\partial }{\partial r} (\frac{\upnu_\phi}{r}) \right)  \\
\dot\varepsilon_{\phi \theta} = \dot\varepsilon_{\theta\phi} 
&=& \frac{1}{2} \left( \frac{\sin \theta}{r} \frac{\partial }{\partial \theta} (\frac{\upnu_\phi}{\sin\theta}) + \frac{1}{r \sin\theta} \frac{\partial \upnu_\theta}{\partial \phi}    \right) 
\end{eqnarray}



%...............................................................................
\subsection{Relationship between Cartesian and polar coordinates expressions}

We can go from Cartesian to polar coordinates  via the $2\times 2$ transformation matrix:
\begin{equation}
{\cal P}=
\left(
\begin{array}{ccc}
\cos\theta & \sin\theta \\
-\sin\theta & \cos\theta
\end{array}
\right)
\end{equation}
The rows correspond to the components of $\vec{e}_r$ and $\vec{e}_\theta$ in the Cartesian basis.
A vector $\vec{\upnu}$ transforms from one orthonormal basis to another by multiplying it by 
the matrix ${\cal P}$. As we have seen before, this yields
\begin{eqnarray}
\upnu_r &=& u \cos\theta + v \sin\theta \\
\upnu_\theta &=& -u \sin\theta + v \cos\theta
\end{eqnarray}
A second-order tensor ${\bm a}$ is Cartesian coordinates transforms into ${\bm a}^\star$
in polar coordinates by 
\[
{\bm a}^\star = {\cal P} \cdot {\bm a} \cdot {\cal P}^T
\]
and obviously 
\[
{\bm a} = {\cal P}^T \cdot {\bm a}^\star \cdot {\cal P}
\]
We obtain for the strain rate tensor (or the stress tensor):
\begin{eqnarray}
\dot{\varepsilon}_{rr} 
&=& \dot{\varepsilon}_{xx} \cos^2\theta + \dot{\varepsilon}_{yy} \sin^2\theta 
+ 2 \dot{\varepsilon}_{xy} \sin\theta\cos\theta \nn\\
\dot{\varepsilon}_{\theta\theta}
&=& \dot{\varepsilon}_{xx} \sin^2\theta + \dot{\varepsilon}_{yy} \cos^2\theta 
- 2 \dot{\varepsilon}_{xy} \sin\theta\cos\theta \nn\\
\dot{\varepsilon}_{r\theta} 
&=& \dot{\varepsilon}_{xy} (\cos^2\theta-\sin^2\theta) + 
(\dot{\varepsilon}_{yy} - \dot{\varepsilon}_{xx})\sin\theta \cos\theta \nn
\end{eqnarray}
Using the trigonometric identities $\sin 2\theta = 2 \sin\theta\cos\theta$
and $\cos^2\theta-\sin^2\theta = \cos 2\theta$
, then 
we obtain 
\begin{eqnarray}
\dot{\varepsilon}_{rr} 
&=& \dot{\varepsilon}_{xx} \cos^2\theta + \dot{\varepsilon}_{yy} \sin^2\theta 
+  \dot{\varepsilon}_{xy} \sin 2\theta \nn\\
\dot{\varepsilon}_{\theta\theta}
&=& \dot{\varepsilon}_{xx} \sin^2\theta + \dot{\varepsilon}_{yy} \cos^2\theta 
-  \dot{\varepsilon}_{xy} \sin 2\theta \nn\\
\dot{\varepsilon}_{r\theta} 
&=& \dot{\varepsilon}_{xy} \cos 2\theta + 
\frac12(\dot{\varepsilon}_{yy} - \dot{\varepsilon}_{xx}) \sin 2\theta  \nn
\end{eqnarray}



and likewise:
\begin{eqnarray}
\dot{\varepsilon}_{xx} 
&=& \dot{\varepsilon}_{rr} \cos^2\theta + \dot{\varepsilon}_{\theta\theta} \sin^2\theta - 2 \dot{\varepsilon}_{r\theta} \sin\theta\cos\theta \\
\dot{\varepsilon}_{yy}
&=& \dot{\varepsilon}_{rr} \sin^2\theta + \dot{\varepsilon}_{\theta\theta} \cos^2\theta + 2 \dot{\varepsilon}_{r\theta} \sin\theta\cos\theta \\
\dot{\varepsilon}_{xy} 
&=& \dot{\varepsilon}_{r\theta} (\cos^2\theta-\sin^2\theta) + 
(\dot{\varepsilon}_{rr} - \dot{\varepsilon}_{\theta\theta})\sin\theta \cos\theta \label{ss:srboth}
\end{eqnarray}
















