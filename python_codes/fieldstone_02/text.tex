\includegraphics[height=1.25cm]{images/pictograms/FEM}
\includegraphics[height=1.25cm]{images/pictograms/paraview}
\includegraphics[height=1.25cm]{images/pictograms/clean}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
\inpython
{\small Code: \url{https://github.com/cedrict/fieldstone/tree/master/python_codes/fieldstone_02}}
\end{center}

\par\noindent\rule{\textwidth}{0.4pt}

Last revision: January 17th, 2026.

\par\noindent\rule{\textwidth}{0.4pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This stone carries out the benchmark of Section~\ref{MMM-ss:stokes_sphere2D} (see manual.pdf)
with $Q_1\times P_0$ elements using the penalty formulation. 
The physical domain is a unit square and the fluid is characterised 
by $\rho=1$ and $\eta=1$ while the sphere is characterised by $\rho=1.01$ and $\eta=1000$.
\begin{lstlisting}
def density(x,y):
    if (x-.5)**2+(y-0.5)**2<0.123456789**2:
       val=1.01
    else:
       val=1.
    return val

def viscosity(x,y):
    if (x-.5)**2+(y-0.5)**2<0.123456789**2:
       val=1.e3
    else:
       val=1.
    return val
\end{lstlisting}

The gravity vector is $\vec{g}=(0,-1)$. 
Boundary conditions are free slip on all sides (\lstinline{bc_type=0}), 
no slip on all sides (\lstinline{bc_type=1}) or free slip on the sides and bottom and open 
on top (\lstinline{bc_type=2}).
Viscosity and density directly computed at the quadrature points.
The results are presented in Section~\ref{MMM-ss:stokes_sphere2D} and compared to 
those obtained with other codes.

Also, because of the inherent symmetry we can solve the system 
on only half the domain (\lstinline{half=True}):
\begin{center}
\includegraphics[width=6cm]{python_codes/fieldstone_02/results/eta_1}
\includegraphics[width=6cm]{python_codes/fieldstone_02/results/eta_2}
\end{center}

\newpage
\begin{center}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/u0}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/v0}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/vel0}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/sr0}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/p0}\\
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/u1}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/v1}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/vel1}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/sr1}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/p1}\\
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/u2}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/v2}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/vel2}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/sr2}
\includegraphics[width=3.4cm]{python_codes/fieldstone_02/results/p2}\\
{\captionfont Results on a $32\times 64$ grid. Top is free-slip, 
middle is no-slip, bottom is open top.}
\end{center}


\begin{center}
\includegraphics[width=5.4cm]{python_codes/fieldstone_02/results/u.pdf}
\includegraphics[width=5.4cm]{python_codes/fieldstone_02/results/v.pdf}
\includegraphics[width=5.4cm]{python_codes/fieldstone_02/results/vrms.pdf}\\
{\captionfont bc\_type=2, half=True}
\end{center}



