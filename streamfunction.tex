\index{general}{Stream Function}
\begin{flushright} {\tiny {\color{gray} streamfunction.tex}} \end{flushright}

%systematically already done 1973,1974,1975, 1981,1982,1983,1984


\begin{scriptsize}
\begin{itemize}
\item[\nineteenseventythree]
\fullcite{mcrw73}
\item[\nineteenseventyfour]
\fullcite{mcrw74}
\item[\nineteenseventyfive]
\fullcite{hemw75} \\
\fullcite{patt75}
\item[\nineteenseventyeight]
\fullcite{hsui78} \\
\fullcite{tosl78} \\
\fullcite{woid78} \\
\fullcite{rimc78}
\item[\nineteenseventynine]
\textcite{ludt79}
\item[\nineteeneightyone]
\textcite{jasc81}\\
\textcite{scja81}\\
\textcite{yups81}\\
\textcite{rimc81}\\
\textcite{homm81}
\item[\nineteeneightytwo]
\textcite{engl82}\\
\textcite{jape82}\\
\textcite{spyk82}
\item[\nineteeneightythree]
\textcite{mato83}\\
\textcite{chri83}
\item[\nineteeneightyfour]
\textcite{chyu84}\\
\textcite{chri84}\\
\textcite{haeb84}
\item[\nineteeneightyfive]
\item[\nineteeneightysix]
\textcite{guda86c}
\item[\nineteeneightyseven]
\item[\nineteeneightyeight]
\textcite{haeb88}
\item[\nineteeneightynine]
\textcite{mayu89}
\item[\nineteenninety] 
\item[\nineteenninetyone] 
\item[\nineteenninetytwo] 
\textcite{hayk92}
\item[\nineteenninetythree] 
\textcite{hayk93}
\item[\nineteenninetyfour] 
\textcite{hayu94}
\item[\nineteenninetyfive] 
\item[\nineteenninetysix] 
\fullcite{laym96}
\item[\nineteenninetyseven] 
\fullcite{laym97}\\
\textcite{olwh97}\\
\fullcite{wahe97}
\item[\nineteenninetyeight] 
\textcite{giju98}
\item[\nineteenninetynine] 
\fullcite{wahe99}\\
\fullcite{sola99}
\item[\twothousandeight] 
\textcite{vanv08}
\item[\twothousandeleven] 
\textcite{vanj11}
\end{itemize}
\end{scriptsize}





\vspace{0.5cm}

The Stream function (commonly denoted by $\Phi$ or $\Psi$) approach is a useful approach in 
fluid dynamics as it 
can provide relatively quick solutions to 2D incompressible flow problems.
Using a stream function
formulation is numerically convenient because velocity information is contained in a single scalar equation
and pressure vanishes from the solution process.
The stream function is a function of coordinates and time of an inviscid liquid.
It allows to determine the components of velocity by differentiating the stream function 
with respect to the space coordinates. 
A family of curves $\Psi = constant$ represent {\color{olive} streamlines}, i.e. 
the stream function remains constant along a streamline. 
Although also valid in 3D, this approach is mostly used in 2D because of its 
relative simplicity.

%............................................
\subsection{In Cartesian coordinates - 2D}

In two dimensions the velocity is obtained as follows:
\begin{equation}
{\vec \upnu} = (u,v) = \left( \frac{\partial \Psi}{\partial y},-\frac{\partial \Psi}{\partial x} \right) 
\end{equation}
Provided the function $\Psi$ is a smooth enough function, 
this automatically insures that the flow is incompressible:
\begin{equation}
{\vec \nabla}\cdot {\vec \upnu} = 
\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}
=
\frac{\partial^2 \Psi}{\partial xy} - \frac{\partial^2 \Psi}{\partial xy} =0 
\end{equation}
Assuming constant viscosity, the Stokes equation writes:
\begin{equation}
-{\vec \nabla}p + \eta \Delta {\vec \upnu} + \rho {\vec g} = \vec{0}
\end{equation}
Let us introduce the vector $\vec{W}=(W_x,W_y)$ for convenience such that in each dimension:
\begin{eqnarray}
W_x&=&-\frac{\partial p}{\partial x} 
+ \eta\left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial x^y} \right) \\
W_y&=&-\frac{\partial p}{\partial y} 
+ \eta \left(\frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial x^y} \right) 
\end{eqnarray}
Taking the curl of the vector ${\vec{W}}$ and only considering the component 
perpendicular to the $xy$-plane:
\begin{equation}
\frac{\partial W_y}{\partial x} - \frac{\partial W_x}{\partial y}  = 
-\frac{\partial \rho g_y}{\partial x} + \frac{\partial \rho g_x}{\partial y}   
\end{equation}
The advantage of this approach is that the pressure terms cancel out 
(the curl of a gradient is always zero\footnote{\url{https://mathinsight.org/curl_gradient_zero}}), 
so that:
\begin{equation}
\frac{\partial}{\partial x}\eta\left( \frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial x^y}  \right) 
- \frac{\partial }{\partial y} \eta \left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial x^y} \right) = 
-\frac{\partial \rho g_y}{\partial x} + \frac{\partial \rho g_x}{\partial y}   
\end{equation}
and then replacing $u,v$ by the their stream function derivatives yields (for a constant viscosity):
\begin{equation}
\eta \left(\frac{\partial^4 \Psi}{\partial x^4} + 
\frac{\partial^4 \Psi}{\partial y^4} + 
2\frac{\partial^4 \Psi}{\partial x^2y^2} \right)
=
-\frac{\partial \rho g_y}{\partial x} + \frac{\partial \rho g_x}{\partial y}   
\end{equation}
or, 
\begin{equation}
\eta {\vec \nabla}^4 \Psi 
=
\left(\frac{\partial^2 }{\partial x^2} + \frac{\partial^2 }{\partial y^2} \right) 
\left(\frac{\partial^2 }{\partial x^2} + \frac{\partial^2 }{\partial y^2} \right) \Psi
=
-\frac{\partial \rho g_y}{\partial x} + \frac{\partial \rho g_x}{\partial y}   
\label{eq:sf1}
\end{equation}
Note that $\vec\nabla^2 \vec\nabla^2 = \vec\nabla^4 $ is known as the {\color{olive}Biharmonic operator}.
\index{general}{Biharmonic Operator} 
These equations are also to be found in the geodynamics literature, 
see \textcite[eq. 1.43]{tack10} or \textcite[p 70-71]{gery10}.

In the presence of temperature variations and multiple compositions, 
\textcite{trlb20} (2020)  use the  following nondimensional equation:
\[
\left(
\frac{\partial^2 }{\partial x^2} - 
\frac{\partial^2 }{\partial y^2}  
\right)
\left[ \eta
\left(
\frac{\partial^2 \Psi}{\partial x^2} - 
\frac{\partial^2 \Psi}{\partial y^2}  
\right)
\right]
+4
\frac{\partial^2 }{\partial xy} 
\left[
\eta 
\frac{\partial^2 \Psi}{\partial xy} 
\right]
=
Ra_T \frac{\partial T}{\partial x}-
Ra_C \frac{\partial C}{\partial x}
\]
\todo[inline]{check/rederive this formula!}

%........................................
%\subsubsection{In Cylindrical coordinates}

%TODO

%VERIFY THOSE! minus signs ?
%\[
%\upnu_r=\frac{1}{r}\frac{\partial \Phi}{\partial \theta} 
%\]
%\[
%\upnu_\theta=-\frac{\partial \Phi}{\partial r} 
%\]

Let us now look at boundary conditions!


%............................................
\subsection{In Cartesian coordinates - 3D}

See for example \textcite{hous90} (1990) and refs therein.


